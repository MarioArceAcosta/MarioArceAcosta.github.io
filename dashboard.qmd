---
title: "Interactive Analytics"
engine: knitr
format: 
  dashboard:
    theme: cosmo
    orientation: rows
---

# Plots

```{r setup, include=FALSE}
# This tells Quarto to use the environment we just made 
library(reticulate) 
use_virtualenv("stats-env", required = TRUE)
```

```{python}
import plotly.express as px
fig = px.scatter(x=[1, 2, 3], y=[4, 1, 2])
fig.show()
```

# Map

##  {.sidebar}

This dashboard analyzes labor market trends and immigration flows.

-   **Filters:** Use the dropdowns on the charts to filter by Year.
-   **Tech Stack:** Python, Plotly, PostgreSQL.
-   **Data Source:** Sample Labor Statistics.

## Row {height="60%"}

### Map of Location Counts

```{python}
import plotly.express as px 
import pandas as pd


# Sample Data: Replace with your PostgreSQL query results
data = {
    'State': ['CA', 'TX', 'NY', 'FL', 'IL', 'CA', 'TX', 'NY'],
    'Year': [2020, 2020, 2020, 2020, 2021, 2021, 2021, 2021],
    'Counts': [150, 130, 120, 100, 170, 140, 130, 110]
}
df = pd.DataFrame(data)

# Create a Choropleth Map with an Animation Slider for Years
fig_map = px.choropleth(
    df,
    locations='State',
    locationmode="USA-states",
    color='Counts',
    animation_frame='Year', # This adds the continuous slider
    scope="usa",
    color_continuous_scale="Viridis",
    title="Immigration/Case Counts by State"
)

fig_map.update_layout(margin={"r":0,"t":40,"l":0,"b":0})
fig_map.show()
```
